Code Version:

| 时间       | 版本号      | 压缩包名称                                                   | 详情         |
| ---------- | ----------- | ------------------------------------------------------------ | ------------ |
| 2024-09-12 | code_1_0912 | D:\Keil5\FMD\ZFMJ_Succeed_Version\mcudemo_Version_2024-09-12.zip | 初始版本数据 |

------

1、INPUT

```c
P_C_INPUT_1		纸盘高位
P_C_INPUT_6		低位传感器		
	P_C_INPUT_1 == 1 && P_C_INPUT_6 == 1	高位	
    P_C_INPUT_1 == 0 && P_C_INPUT_6 == 0	低位	
    P_C_INPUT_1 == 0 && P_C_INPUT_6 == 1
P_C_INPUT_5 	飞达传感器		0--亮 	1--不亮
P_C_INPUT_2		进纸传感器		0--没纸	1--有纸
P_C_INPUT_3 	出纸传感器		0--没纸	1--有纸
P_C_INPUT_7		主轴点动		
P_C_INPUT_8		急停
P_C_INPUT_9		平台上升
P_C_INPUT_10	平台下降
P_C_INPUT_11	断纸传感器
```

2、OUTPUT

```c
P_C_OUT_1	
P_C_OUT_2		进纸电磁阀	1：上升	0：下降
P_C_OUT_3		对齐电磁阀	1：上升	0：下降
P_C_OUT_4		下滚主轴	1：下降	0：上升
P_C_OUT_5		气泵开关	1：代开	0：关闭
P_C_OUT_6		PWM波控制,加热
P_C_OUT_7		送纸气泵	1：关闭	0：打开
P_C_OUT_8
P_C_OUT_9    
P_C_OUT_10    
P_C_OUT_11    
P_C_OUT_12    
P_C_OUT_13    
P_C_OUT_14    
P_C_OUT_15		进纸检测使能	1：关闭	0：打开
```

3、电机

```c
电机1				断纸电机
电机2				主轴电机
电机3				纸盘电机
电机4				出纸电机
电机5				飞达电机
电机6
电机7
电机8
//=============================================================================================================//
电机2	计算长度: 传动比40:1	轴细分:2000	轴直径:140.000 mm	工作轴:一周 440,000 um
		单位脉冲	e = 440000/(40*2000*4) = 1.375 um
```

4、AD

```
AD3		温度采样
AD4		速度		往左小，往右大
```

------

| 主轴频率 | 飞达脉冲 (10000)                                       | 断纸脉冲 (10000)                                             |
| :------- | ------------------------------------------------------ | ------------------------------------------------------------ |
| 10000    | 172,200==>172200*1.375=236,775==>22.386cm<br />400,000 | 400,000==>400000*1.375=520,000==>55 cm<br />断口==>57894×1.375==>7.9604 cm<br />非断口==>355480×1.375==>48.8785 cm |

```
纸长 >= 520mm / m			  m = 断纸FHZ/主轴FHZ
送下一张长 >= 225mm / n		n = 飞达FHZ/主轴FHZ

A1纸的尺寸（2开） 594mm×841mm
A2纸的尺寸（4开） 420mm×594mm
A3纸的尺寸（8开） 297mm×420mm
A4纸的尺寸（16开） 210mm×297mm
A5纸的尺寸（32开） 148mm×210mm

100000 >= FH2
100000 >= FH1 >= 550*FH2/LEN
100000 >= FH2 >= 448*FH2/LEN
```

```
15:55:50:587: Info: 执行操作	10000	10000			227,908
15:55:54:851: Info: 飞达从亮到不亮 编码器值: "173607"
15:56:00:851: Info: 飞达从不亮到亮 编码器值: "401515"			
15:56:04:894: Info: 飞达从亮到不亮 编码器值: "573682"
15:56:10:957: Info: 飞达从不亮到亮 编码器值: "801501"			172,206
15:56:14:851: Info: 飞达从亮到不亮 编码器值: "973707"
15:56:20:924: Info: 飞达从不亮到亮 编码器值: "1201519"			172,181
15:56:24:850: Info: 飞达从亮到不亮 编码器值: "1373700"
15:56:31:390: Info: 飞达从_不亮_到_亮_ 编码器值: "1601522"		172,202
15:56:34:851: Info: 飞达从_亮_到_不亮_ 编码器值: "1773724"
```

```
16:10:58:722: Info: 执行操作	10000	10000
16:10:58:735: Info: 测试断纸电机
16:10:59:724: Info: 断纸传感器从_亮_到_不亮_ 编码器值: "10299"	上升沿
16:11:00:005: Info: 断纸传感器从_不亮_到_亮_ 编码器值: "54781"	下降沿
16:11:08:894: Info: 断纸传感器从_亮_到_不亮_ 编码器值: "410267"
16:11:10:901: Info: 断纸传感器从_不亮_到_亮_ 编码器值: "454806"
16:11:18:893: Info: 断纸传感器从_亮_到_不亮_ 编码器值: "810280"
16:11:20:912: Info: 断纸传感器从_不亮_到_亮_ 编码器值: "854808"
```

| 主轴频率 | 移动距离(mm) |
| :------: | :----------: |
|  10000   |     3273     |
|  20000   |     6550     |
|  30000   |     9847     |
|  40000   |    13177     |
|  50000   |    16486     |
|  60000   |    19764     |
|  70000   |    22989     |

------

1、出现情况，飞达因为纸盘上升顶起来：

```C
A.纸盘上升的频率调慢。
B.进纸电池阀把纸张顶起来，导致高位传感器裸露，进而纸盘上升。
解决方法:
	进纸电磁阀立时,不关注高位传感器裸露
	进纸电磁阀倒时,查看纸盘高位传感器是否裸露
```

2、出现情况，纸盘在顶部机器暂停时，纸张覆盖导致传感器折射进入接收端
	A.开始时先把进纸电磁阀倒下去，再检测传感器，再启动

------

3、2024-9-7 今天测速发现一个问题: 我今天怀疑是每一次启动的时候有一段距离编码器开始计算，但是主轴没能带动纸张。

------

4、需要使用的字

```
纸张长度为重叠小于对齐断比例错误请新设置主轴频率机器正在运行已经停止飞达电出盘指令发送失败套接字收进传感平台位覆膜滚低下高中间完成数连状态加热温速警告信息无开始暂上初化硬件测试语言配段名称值网络启时据报隔采样细分直径落一次后退升读取写入动向气泵降打关闭压力卡选择过未检到记录窗口其他米秒℃文递补消磁阀执操作确定亮单
```

5、LVGL问题

```
sprintf %f输出f不显示小数	lv_conf LV_SPRINTF_CUSTOM 置一
```

6、linux共享文件夹重启问题

```
sudo /usr/bin/vmhgfs-fuse .host:/ /mnt/hgfs -o allow_other

sudo vmhgfs-fuse .host:/ /mnt/hgfs -o nonempty -o allow_other
```

